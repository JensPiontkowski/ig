`qig` <-
function(p,mu=1.0,lambda=1.0,kernel="normal",parameter.nu=1.0,lower.tail=TRUE,log.p=FALSE){
mu2<-mu
lambda2<-lambda
nu2<-parameter.nu
n<-length(p)
vector.q<-seq(1,n)
if(kernel=="normal"){
for(i in 1:n){
pe<-p[i]
f<-function(x,p=pe,mu=mu2,lambda=lambda2,kernel="normal"){
a<-mu
b<-lambda
res<-pig(x,mu=a,lambda=b,kernel="normal")-p
return(res)
}
ecuacion<-uniroot(f,c(0,5000),tol=0.000000000000000000000000000000001)
raiz<-ecuacion$root
vector.q[i]<-raiz
}
cuantil<-vector.q
}
if(kernel=="t"){
for(i in 1:n){
pe<-p[i]
f<-function(x,p=pe,mu=mu2,lambda=lambda2,kernel="t",parameter.nu=nu2){
a<-mu
b<-lambda
c<-parameter.nu
res<-pig(x,mu=a,lambda=b,kernel="t",parameter.nu=c)-p
return(res)
}
ecuacion<-uniroot(f,c(0,5000),tol=0.000000000000000000000000000000001)
raiz<-ecuacion$root
vector.q[i]<-raiz
}
cuantil<-vector.q
}
if(kernel=="logistic"){
for(i in 1:n){
pe<-p[i]
f<-function(x,p=pe,mu=mu2,lambda=lambda2,kernel="logistic"){
a<-mu
b<-lambda
res<-pig(x,mu=a,lambda=b,kernel="logistic")-p
return(res)
}
ecuacion<-uniroot(f,c(0,5000),tol=0.000000000000000000000000000000001)
raiz<-ecuacion$root
vector.q[i]<-raiz
}
cuantil<-vector.q
}
if(kernel=="Laplace"){
for(i in 1:n){
pe<-p[i]
f<-function(x,p=pe,mu=mu2,lambda=lambda2,kernel="Laplace"){
a<-mu
b<-lambda
res<-pig(x,mu=a,lambda=b,kernel="Laplace")-p
return(res)
}
ecuacion<-uniroot(f,c(0,5000),tol=0.000000000000000000000000000000001)
raiz<-ecuacion$root
vector.q[i]<-raiz
}
cuantil<-vector.q
}
if(lower.tail==FALSE){cuantil<-(1-cuantil)}
if(log.p==TRUE){cuantil<-log(cuantil)}
return(cuantil)
}

